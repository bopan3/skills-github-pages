---
title: "扩散模型原理"
date: 2024-05-01
---
本文从一个初学者的角度介绍扩散模型原理。
# 1.生成模型
首先扩散模型是一类生成模型，近年来因为其一些优秀的性质在各种类型的生成任务上取得了很好的效果。那什么是生成模型呢？字面上来说，生成模型就是一个能够生成样本的模型。比如说针对 $R$ 这个一维空间，我们有一个生成模型 $M$，每次对这个模型采样，我们就能够生成一个一维向量样本 $\boldsymbol{x}$。而生成模型 $M$ 则决定了 $R$ 这个空间中每个点被采样为样本的可能性，即概率分布 $p(\boldsymbol{x})$. 

我们可以看一个简单的生成模型例子，正态分布 $X \sim N(0, 1)$：
$$
p(x) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
$$
这里我们直接写出了该生成模型概率分布的$p(x)$的解析形式。那么我们如何基于这个解析形式去做样本的采样生成呢？一种最基本的思路是[逆变换采样法](https://zh.wikipedia.org/zh-cn/%E9%80%86%E5%8F%98%E6%8D%A2%E9%87%87%E6%A0%B7),即通过求出概率分布的 $p(x)$ 的累积分布函数 $F(x)$ 再求逆函数得到 $F^{-1}(x)$。然后我们只需要从最简单的$Z \sim U(0, 1)$ 中采样一个$z$, 再进行逆变换即可得到目标样本 $ x = F^{-1}(z)$. 

一般拿到/学到了一个生成模型后，我们主要可以应用它做两个事。1.采样新的样本（即做生成）。2.估计一个样本的可能性（likelihood）。当然，面对现实中各种复杂的分布（如自然图片），直接对$p(x)$建模是非常困难的，即使我们把这个模型建出来了，直接对这么复杂的模型做逆变换采样也很难做到，因此，我们需要构造一些巧妙的结构来实现生成模型的建模和采样，这个需求推动学术界提出了一系列生成模型，GAN(生成对抗网络)、VAE（变分自编码器）、扩散模型就是其中的几种生成模型建模方式。

# 2.VAE生成模型
从第一节（生成模型）中我们可以发现，